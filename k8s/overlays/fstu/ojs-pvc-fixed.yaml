# OJS FSTU Persistent Volume Claims - Fixed Version
# This uses dynamic provisioning to prevent binding issues

apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: ojs-mysql-fstu-pvc
  namespace: ojs-fstu
  labels:
    app: ojs-mysql-fstu
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 20Gi
  storageClassName: local-path
  # Remove volumeName to allow dynamic binding

---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: ojs-files-fstu-pvc
  namespace: ojs-fstu
  labels:
    app: ojs-fstu
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 10Gi
  storageClassName: local-path
  # Remove volumeName to allow dynamic binding

---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: ojs-public-fstu-pvc
  namespace: ojs-fstu
  labels:
    app: ojs-fstu
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
  storageClassName: local-path
  # Remove volumeName to allow dynamic binding

---
# OJS Application Directory PersistentVolume
# This allows modifications to OJS core files (submission form, etc.)
apiVersion: v1
kind: PersistentVolume
metadata:
  name: ojs-app-pv-fstu
spec:
  capacity:
    storage: 2Gi
  accessModes:
    - ReadWriteOnce
  storageClassName: local-path
  persistentVolumeReclaimPolicy: Retain
  hostPath:
    path: /opt/local-path-provisioner/ojs-app-data-fstu

---
# OJS Application Directory PersistentVolumeClaim
# This allows modifications to OJS core files (submission form, etc.)
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: ojs-app-fstu-pvc
  namespace: ojs-fstu
  labels:
    app: ojs-fstu
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi
  volumeName: ojs-app-pv-fstu
  storageClassName: local-path
  # This volume stores the entire /var/www/html directory for code modifications
  # Host path: /opt/local-path-provisioner/ojs-app-data-fstu